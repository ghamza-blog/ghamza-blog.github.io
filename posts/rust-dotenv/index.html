<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Rust .env - Ghamza Blog</title><link rel=apple-touch-icon sizes=180x180 href=https://static.ghamza.dev/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://static.ghamza.dev/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://static.ghamza.dev/icons/favicon-16x16.png><link rel=manifest href=https://static.ghamza.dev/icons/site.webmanifest><script async src="https://www.googletagmanager.com/gtag/js?id=G-M9GYS9Z1XC"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M9GYS9Z1XC")</script><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Load Environment Variales in Rust"><meta property="og:image" content><meta property="og:title" content="Rust .env"><meta property="og:description" content="Load Environment Variales in Rust"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.ghamza.dev/posts/rust-dotenv/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-11T03:09:15+02:00"><meta property="article:modified_time" content="2023-01-11T03:09:15+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rust .env"><meta name=twitter:description content="Load Environment Variales in Rust"><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script>
<link href="https://fonts.googleapis.com/css?family=Fira+Code" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://blog.ghamza.dev/css/main.fdba4ef306acb1dca5545b96e6818114a6bc828051e907b6d87e2472065dfe9d.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://blog.ghamza.dev/css/dark.5fd3ce147f5045c9d9c6e91eebbaa9ffa6b563a220315a3be3a7d8e93c3cf380.css></head><body><div class=content><div class=support-ribbon>🕊️🇵🇸 I stand with humanity, I stand with Palestine 🇵🇸🕊️</div><header><div class=main><a href=https://blog.ghamza.dev>Ghamza Blog</a></div><nav><a href=/posts>Archives</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Rust .env</h1><div class=meta>Posted on Jan 11, 2023</div></div><section class=body><h2 id=environment-variables>Environment Variables</h2><p>Good practice in software development is parametrizing our environment; for example, if we&rsquo;re accessing a database and want to store the URL, username, and password, we should parametrize them so we can deploy staging and production environments without changing code.</p><h2 id=enviroment-varaibles-in-rust>Enviroment Varaibles in Rust</h2><p>We can access the environment variables from <code>std::env::var</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#c2ffdf>use</span><span style=color:#a8757b> </span>std::env;<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#a8757b></span><span style=color:#c2ffdf>fn</span> <span style=color:#ceb1ff>main</span>()<span style=color:#a8757b> </span>{<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_url<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>env::var(<span style=color:#1bc5e0>&#34;DB_URL&#34;</span>).unwrap();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_user<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>env::var(<span style=color:#1bc5e0>&#34;DB_USER&#34;</span>).unwrap();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_pass<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>env::var(<span style=color:#1bc5e0>&#34;DB_PASS&#34;</span>).unwrap();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#a8757b>    </span>println!(<span style=color:#1bc5e0>&#34;{db_url} {db_user} {db_pass}&#34;</span>);<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span><span style=color:#a8757b></span>}<span style=color:#a8757b>
</span></span></span></code></pre></div><p>Then we can run the project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>DB_URL<span style=color:#ffb8d1>=</span>database.com DB_USER<span style=color:#ffb8d1>=</span>dbuser DB_PASS<span style=color:#ffb8d1>=</span>password cargo run
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#b0bec5># will output</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#b0bec5># database.com dbuser password</span>
</span></span></code></pre></div><p>Now appending the env variables at the start of the command doesn&rsquo;t feel right.</p><h2 id=env>.env</h2><p>The <code>.env</code> will make our parametrizion much easier by storing all our env vars in it.</p><p>Add <code>dotenv</code> crate.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>cargo add dotenv
</span></span></code></pre></div><p>Then put your environment variables in a <code>.env</code> file in the form of <code>KEY=value</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>DB_URL=database.com
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>DB_USER=dbuser
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>DB_PASS=password
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span># This is a comment
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span># SECRET_KEY=1234
</span></span></code></pre></div><p>Finally, call <code>dotnev()</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#c2ffdf>use</span><span style=color:#a8757b> </span>dotenv::dotenv;<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#a8757b></span><span style=color:#c2ffdf>use</span><span style=color:#a8757b> </span>std::env;<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#a8757b></span><span style=color:#c2ffdf>fn</span> <span style=color:#ceb1ff>main</span>()<span style=color:#a8757b> </span>{<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#a8757b>    </span>_<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>dotenv();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_url<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>env::var(<span style=color:#1bc5e0>&#34;DB_URL&#34;</span>).unwrap();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_user<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>env::var(<span style=color:#1bc5e0>&#34;DB_USER&#34;</span>).unwrap();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_pass<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>env::var(<span style=color:#1bc5e0>&#34;DB_PASS&#34;</span>).unwrap();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#a8757b>    </span>println!(<span style=color:#1bc5e0>&#34;{db_url} {db_user} {db_pass}&#34;</span>);<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#a8757b></span>}<span style=color:#a8757b>
</span></span></span></code></pre></div><hr><p><strong>Lots of boilerplates?</strong></p><p>Use <code>dotenv_codegen</code>, and getting the environment variable is as simple as <code>dotenv("DB_USER")</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>cargo add dotenv_codegen
</span></span></code></pre></div><p>Final code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#b0bec5>#[macro_use]</span><span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#a8757b></span><span style=color:#c2ffdf>extern</span><span style=color:#a8757b> </span><span style=color:#c2ffdf>crate</span><span style=color:#a8757b> </span>dotenv_codegen;<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#a8757b></span><span style=color:#c2ffdf>use</span><span style=color:#a8757b> </span>dotenv::dotenv;<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#a8757b></span><span style=color:#c2ffdf>fn</span> <span style=color:#ceb1ff>main</span>()<span style=color:#a8757b> </span>{<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#a8757b>    </span>_<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>dotenv();<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_url<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>dotenv<span style=color:#ffb8d1>!</span>(<span style=color:#1bc5e0>&#34;DB_URL&#34;</span>);<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_user<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>dotenv<span style=color:#ffb8d1>!</span>(<span style=color:#1bc5e0>&#34;DB_USER&#34;</span>);<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#a8757b>    </span><span style=color:#c2ffdf>let</span><span style=color:#a8757b> </span>db_pass<span style=color:#a8757b> </span><span style=color:#ffb8d1>=</span><span style=color:#a8757b> </span>dotenv<span style=color:#ffb8d1>!</span>(<span style=color:#1bc5e0>&#34;DB_PASS&#34;</span>);<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#a8757b>    </span>println!(<span style=color:#1bc5e0>&#34;{db_url} {db_user} {db_pass}&#34;</span>);<span style=color:#a8757b>
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#a8757b></span>}<span style=color:#a8757b>
</span></span></span></code></pre></div></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/rust>Rust</a></li></ul></nav></div></article><script src=https://giscus.app/client.js data-repo=ghamza-blog/ghamza-blog.github.io data-repo-id=R_kgDOHMIi9w data-category-id=DIC_kwDOHMIi984COoB4 data-mapping=url data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></main><footer><div style=display:flex><a href=https://github.com/Ghamza-Jd title=GitHub><i data-feather=github></i></a>
|<a href=https://www.facebook.com/ghamza.tech title=Facebook><i data-feather=facebook></i></a>
|<a href=https://www.linkedin.com/in/hamza-jadid title=LinkedIn><i data-feather=linkedin></i></a>
|<a href=https://blog.ghamza.dev/index.xml title=rss><i data-feather=rss></i></a>
|</div><div class=footer-info>&nbsp2023  © Hamza Jadid | 
 </div></footer><script>feather.replace()</script></div></body></html>